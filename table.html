{# [module]/templates/home-template.html.twig #}

{# <p>test_var: {{ dump(record_salary) }}</p> #}
{# <p>test_var: {{ dump(displaySalary) }}</p> #}
    <!-- Gendrate PDF using jsPDF library   Start      -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.0.272/jspdf.debug.js"></script>
    {% if displaySalary == 0 %}
    <div id='chkMonthSalaryForm' style="display:block">
      <form action="" method="get">
        <select name="salaryMonth" id="salaryMonth">
          <option value=''>--Select Month--</option>
          <option value='1'>Janaury</option>
          <option value='2'>February</option>
          <option value='3'>March</option>
          <option value='4'>April</option>
          <option value='5'>May</option>
          <option value='6'>June</option>
          <option value='7'>July</option>
          <option value='8'>August</option>
          <option value='9'>September</option>
          <option value='10'>October</option>
          <option value='11'>November</option>
          <option value='12'>December</option>
        </select><br><br>
        <select name="salaryYear" id="salaryYear">
          <option value="">-- Select Year --</option>
          <option value="2021">2021</option>
          <option value="2020">2020</option>
          <option value="2019">2019</option>
          <option value="2018">2018</option>
          <option value="2017">2017</option>
          <option value="2016">2016</option>
          <option value="2015">2015</option>
          <option value="2014">2014</option>
          <option value="2013">2013</option>
          <option value="2012">2012</option>
          <option value="2011">2011</option>
        </select><br><br>
        <input type="submit" value="Submit">
      </form>
    </div>
    {% endif %}
    {% if displaySalary == 1 %}
    <div  id='salaryDetails' style="">
      <div class="col-md-12 col-sm-12 col-xs-12" id="pdfbtn">
          <div  onclick="javascript:saveAspdf()" style="float:right;cursor: pointer;">
              <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16"  fill="#dc3545" class="bi bi-file-pdf-fill" viewBox="0 0 16 16">
                  <path d="M5.523 10.424c.14-.082.293-.162.459-.238a7.878 7.878 0 0 1-.45.606c-.28.337-.498.516-.635.572a.266.266 0 0 1-.035.012.282.282 0 0 1-.026-.044c-.056-.11-.054-.216.04-.36.106-.165.319-.354.647-.548zm2.455-1.647c-.119.025-.237.05-.356.078a21.035 21.035 0 0 0 .5-1.05 11.96 11.96 0 0 0 .51.858c-.217.032-.436.07-.654.114zm2.525.939a3.888 3.888 0 0 1-.435-.41c.228.005.434.022.612.054.317.057.466.147.518.209a.095.095 0 0 1 .026.064.436.436 0 0 1-.06.2.307.307 0 0 1-.094.124.107.107 0 0 1-.069.015c-.09-.003-.258-.066-.498-.256zM8.278 4.97c-.04.244-.108.524-.2.829a4.86 4.86 0 0 1-.089-.346c-.076-.353-.087-.63-.046-.822.038-.177.11-.248.196-.283a.517.517 0 0 1 .145-.04c.013.03.028.092.032.198.005.122-.007.277-.038.465z"></path>
                  <path fill-rule="evenodd" d="M4 0h8a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2zm.165 11.668c.09.18.23.343.438.419.207.075.412.04.58-.03.318-.13.635-.436.926-.786.333-.401.683-.927 1.021-1.51a11.64 11.64 0 0 1 1.997-.406c.3.383.61.713.91.95.28.22.603.403.934.417a.856.856 0 0 0 .51-.138c.155-.101.27-.247.354-.416.09-.181.145-.37.138-.563a.844.844 0 0 0-.2-.518c-.226-.27-.596-.4-.96-.465a5.76 5.76 0 0 0-1.335-.05 10.954 10.954 0 0 1-.98-1.686c.25-.66.437-1.284.52-1.794.036-.218.055-.426.048-.614a1.238 1.238 0 0 0-.127-.538.7.7 0 0 0-.477-.365c-.202-.043-.41 0-.601.077-.377.15-.576.47-.651.823-.073.34-.04.736.046 1.136.088.406.238.848.43 1.295a19.707 19.707 0 0 1-1.062 2.227 7.662 7.662 0 0 0-1.482.645c-.37.22-.699.48-.897.787-.21.326-.275.714-.08 1.103z"></path>
              </svg>
              <span style="font-size: 17px;">Download</span>
          </div>
      </div>
      <div id='pdfDom1' style='font-family: "Open Sans", Arial, sans-serif;font-size: 12px;color: black;background-color:white;'>
      
        <img src="/empportalpmrp/sites/default/files/salarySlipHeader.PNG" style="width: 100%;">
        <table style='border: 1px solid black;width:99%;font-size: 12px;'>
        <tr style='border: 1px solid black;'>
          <th style="background-color: #f78320;border: 1px solid black;"><input type="text" name="Name">Name</th>
          <td style="border: 1px solid black;">{{record_salary['empNm']}}</td>
          <th style="background-color: #f78320;border: 1px solid black;">PAN No</th>
          <td style="border: 1px solid black;">{{record_salary['panNo']}}</td>
          <th style="background-color: #f78320;border: 1px solid black;">UAN No</th>
          <td style="border: 1px solid black;">{{record_salary['uanNo']}}</td>
        </tr>
        <tr>
          <th style="background-color: #f78320;border: 1px solid black;">Employee No.</th>
          <td style="border: 1px solid black;">00000{{record_salary['empNo']}}</td>
          <th style="background-color: #f78320;border: 1px solid black;">PF No</th>
          <td style="border: 1px solid black;">{{record_salary['pfNo']}}</td>
          <th style="background-color: #f78320;border: 1px solid black;">Pay period</th>
          <td style="border: 1px solid black;">{{record_salary['payPeriod']}}</td>
        </tr>
        <tr>
          <th style="background-color: #f78320;border: 1px solid black;">Designation</th>
          <td style="border: 1px solid black;">{{record_salary['designation']}}</td>
          <th style="background-color: #f78320;border: 1px solid black;">Department</th>
          <td style="border: 1px solid black;">{{record_salary['dept']}}</td>
          <th style="background-color: #f78320;border: 1px solid black;">Bank a/c No.</th>
          <td style="border: 1px solid black;">{{record_salary['bankAc']}}</td>
        </tr>
        <tr>
          <th style="background-color: #f78320;border: 1px solid black;">Location</th>
          <td style="border: 1px solid black;">{{record_salary['pa']}}</td>
          <th style="background-color: #f78320;border: 1px solid black;">Pay Area</th>
          <td style="border: 1px solid black;">{{record_salary['payArea']}}</td>
          <th style="background-color: #f78320;border: 1px solid black;">Pay Scale & Grade</th>
          <td style="border: 1px solid black;">{{record_salary['pscgrade']}}</td>
        </tr>
        <tr>
          <th style="background-color: #f78320;border: 1px solid black;">Date of Joining</th>
          <td style="border: 1px solid black;">{{record_salary['doj']}}</td>
          <th style="background-color: #f78320;border: 1px solid black;">Next Increment Date</th>
          <td style="border: 1px solid black;"></td>
          <th style="background-color: #f78320;border: 1px solid black;"></th>
          <td style="border: 1px solid black;"></td>
        </tr>
        </table>
        <table style='border: 1px solid black;width:99%;border-top: none;font-size: 12px;'>
        <tr>
          <th style="background-color: #f78320;border: 1px solid black;border-top: none;">Earning Details</th>
          <th style="background-color: #f78320;border: 1px solid black;border-top: none;">Amount</th>
          <th style="background-color: #f78320;border: 1px solid black;border-top: none;">Deduction Details</th>
          <th style="background-color: #f78320;border: 1px solid black;border-top: none;">Amount</th>
          <th style="background-color: #f78320;border: 1px solid black;border-top: none;">Summary</th>
          <th style="background-color: #f78320;border: 1px solid black;border-top: none;">Amount</th>
        </tr>
        <tr>
          <td style="border: 1px solid black;">Basic Pay</td>
          <td style="border: 1px solid black;">{{record_salary['earn2']}}</td>
          <td style="border: 1px solid black;">Ee PF contribution</td>
          <td style="border: 1px solid black;">{{record_salary['deduct2']}}</td>
          <td style="border: 1px solid black;">Total gross amount</td>
          <td style="border: 1px solid black;">{{record_salary['summ2']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">DA (IDA)</td>
          <td style="border: 1px solid black;">{{record_salary['earn4']}}</td>
          <td style="border: 1px solid black;">Prof Tax - split period</td>
          <td style="border: 1px solid black;">{{record_salary['deduct4']}}</td>
          <td style="border: 1px solid black;">Deduction</td>
          <td style="border: 1px solid black;">{{record_salary['summ4']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">DA Arr (IDA)</td>
          <td style="border: 1px solid black;"></td>
          <td style="border: 1px solid black;">Income Tax</td>
          <td style="border: 1px solid black;">{{record_salary['deduct6']}}</td>
          <td style="border: 1px solid black;">Net Salary</td>
          <td style="border: 1px solid black;">{{record_salary['summ6']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">Perks (IDA)</td>
          <td style="border: 1px solid black;">{{record_salary['earn6']}}</td>
          <td style="border: 1px solid black;">CF Pf monthly</td>
          <td style="border: 1px solid black;"></td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">CDA+Vehicle</td>
          <td style="border: 1px solid black;">{{record_salary['earn8']}}</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">Exemption U/S 10</td>
          <td style="border: 1px solid black;">&nbsp;</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">HRA (PN)</td>
          <td style="border: 1px solid black;">{{record_salary['earn10']}}</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">Balance</td>
          <td style="border: 1px solid black;">{{record_salary['summ10']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">Std Deduction</td>
          <td style="border: 1px solid black;">{{record_salary['summ12']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">Empmnt tax (Prof Tax)</td>
          <td style="border: 1px solid black;">{{record_salary['summ14']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">Aggrg Deduction</td>
          <td style="border: 1px solid black;">{{record_salary['summ16']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">Incm under Hd Salary</td>
          <td style="border: 1px solid black;">{{record_salary['summ18']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">Gross Tot Income</td>
          <td style="border: 1px solid black;">{{record_salary['summ20']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">Agg of Chapter VI</td>
          <td style="border: 1px solid black;">{{record_salary['summ22']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">Total Income</td>
          <td style="border: 1px solid black;">{{record_salary['summ24']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">Tax payable and surcharge</td>
          <td style="border: 1px solid black;">{{record_salary['summ26']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">Tax deducted so far</td>
          <td style="border: 1px solid black;">{{record_salary['summ28']}}</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">Income Tax</td>
          <td style="border: 1px solid black;">{{record_salary['summ30']}}</td>
        </tr>
        <tr>
          <th style="border: 1px solid black;background-color: #f78320;">Total</th>
          <td style="border: 1px solid black;">{{record_salary['tEarn']}}</td>
          <th style="border: 1px solid black;background-color: #f78320;">Total</th>
          <td style="border: 1px solid black;">{{record_salary['tDeduct']}}</td>
          <td style="border: 1px solid black;"></td>
          <td style="border: 1px solid black;">&nbsp;</td>
        </tr>
        <tr>
          <th style="border: 1px solid black;background-color: #f78320;">Leave Details</th>
          <th style="border: 1px solid black;background-color: #f78320;">Taken</th>
          <th style="border: 1px solid black;background-color: #f78320;">Balance</th>
          <th style="border: 1px solid black;background-color: #f78320;" colspan='2'>Perks/Other income/Exemptions/Rebates</th>
          
          <th style="border: 1px solid black;">&nbsp;</th>
        </tr>
        <tr>
          <td style="border: 1px solid black;">Casual Leave Quota</td>
          <td style="border: 1px solid black;">{{record_salary['taken1']}}</td>
          <td style="border: 1px solid black;">{{record_salary['bal1']}}</td>
          <td style="border: 1px solid black;">Exemption U/S 10</td>
          <td style="border: 1px solid black;">{{record_salary['perks2']}}</td>
          <td style="border: 1px solid black;">&nbsp;</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">Earned Leave Quota</td>
          <td style="border: 1px solid black;">{{record_salary['taken2']}}</td>
          <td style="border: 1px solid black;">{{record_salary['bal2']}}</td>
          <td style="border: 1px solid black;">Agg of Chapter VI</td>
          <td style="border: 1px solid black;">{{record_salary['summ22']}}</td>
          <td style="border: 1px solid black;">&nbsp;</td>
        </tr>
        <tr>
          <td style="border: 1px solid black;">Half Pay Leave Quota</td>
          <td style="border: 1px solid black;">{{record_salary['taken3']}}</td>
          <td style="border: 1px solid black;">{{record_salary['bal3']}}</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
          <td style="border: 1px solid black;">&nbsp;</td>
        </tr>
        </table>
      
      </div>
    </div> 
    {% endif %} 
{# {% for key,value in record_salary %}
    {{key}} : {{value}}</br>
{% endfor %} #}

  
<script type="text/javascript">

    function saveAspdf() {
        var date = new Date();
        var pdf = new jsPDF('p','px','a4');
       
        // var niceimage = new Image();
        // niceimage.src = './images/logo.png';
        // pdf.addHTML($('#pdfDom1')[0],function() {
        //     pdf.save('web.pdf');
        // });
        $('#pdfbtn').hide();  
        source = $('#pdfDom1')[0];
        specialElementHandlers = {
            // element with id of "bypass" - jQuery style selector
            '#bypassme': function (element, renderer) {
                // true = "handled elsewhere, bypass text extraction"
                return true
            }
        };
        margins = {
            top: 5,
            bottom: 260,
            left: 5,
            right: 10,
            width: 2400
        };
        // all coords and widths are in jsPDF instance's declared units
        // 'inches' in this case
        // pdf.text("Pune Metro Rail Project - Salary Slip", 160, 20);
        pdf.addHTML(
            source, // HTML string or DOM elem ref.
            margins.left, // x coord
            margins.top, { // y coord
                'width': margins.width, // max width of content on PDF
                'elementHandlers': specialElementHandlers
            },
            
            
            function (dispose) {
                // dispose: object with X, Y of the last line add to the PDF 
                //          this allow the insertion of new lines after html
                // pdf.addPage();
               //pdf.save('Salary_Slip'+date.getTime()+'.pdf');
                                
                    pdf.save('Salary_Slip_'+date.getTime()+'.pdf');
                    $('#pdfbtn').delay(1000).show();
               
              
                
            }, margins);
            
    }
    
    function saveAspdf1(){
      var pdf = new jsPDF('p','px','a4');
            // change the font size of everything in the area you want to print to a much larger size (mine by default was 12px, so I'm changing it to 22px
      $("#pdfDom1").contents().find("*").css("font-size", "22px");
      // clone it
      var printClone = $("#pdfDom1").clone();
      // get the width and height of all of the content
      var contentHeight = $("#pdfDom1")[0].scrollHeight;
      var contentWidth = $("#pdfDom1")[0].scrollWidth;
      // we have where we create a new div to stuff the content into
      $("#printOutput").append("<div class='pdfDiv' id='pdfDiv'></div>");
      // set the new div height and width to the calculated ones above
      $(".pdfDiv").height(contentHeight);
      $(".pdfDiv").width(contentWidth);
      // add the div to the clone
      printClone.appendTo(".pdfDiv");
      // add the html
      pdf.addHTML($(".pdfDiv")[0],function() {
              // save it
          pdf.save('pdf.pdf');
              // reset the font size
          $("#pdfDom1").contents().find("*").css("font-size", "");
              // remove the div
          $("#pdfDiv").remove();
      });
    }

</script>